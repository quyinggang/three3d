import{O as U,aD as T,s as W,au as E,m as N,y as q,u as H,aa as V,p as j,G as J,ar as K,D as Q,ad as $,ae as ee,z as te,af as ne,A as x}from"./three.module-8f39f104.js";import{O as se}from"./OrbitControls-8206acf3.js";import{_ as ae,r as C,o as oe,a as re,b as ce,c as ie,d as de}from"./index-5a0fd32d.js";const d=50,le={__name:"FlyScene",setup(ue){const P=C(null),R=C(null);let M=null;const h=(e,t)=>{const s=t-e,n=Math.random();return Math.round(n*s+e)},D=()=>{const e=document.createElement("canvas"),t=25,s=window.devicePixelRatio*t;e.width=s,e.height=s;const n=e.getContext("2d");return n.save(),n.beginPath(),n.fillStyle="rgb(228,212,70)",n.shadowColor="rgb(228,212,70)",n.shadowBlur=14,n.shadowOffsetX=0,n.shadowOffsetY=0,n.arc(t,t,8,0,Math.PI*2),n.fill(),n.closePath(),n.restore(),e},L=()=>{const e=[],t=[];for(let p=0;p<333;p++){const w=x.randFloatSpread(10),m=x.randFloatSpread(10),_=x.randFloatSpread(30),f=h(-1,1)*.008,c=h(-1,1)*.008,o=h(-1,1)*.008;e.push(w,Math.max(1,m),_),t.push(f||.008,c||.008,o||.008)}const n=D(),i=new T(n),l=new W;l.setAttribute("position",new E(e,3)),l.setAttribute("customData",new E(t,3));const u=new N({transparent:!0,map:i,depthTest:!1,depthWrite:!1});return new q(l,u)},X=()=>{const e=new H(new V(d*2,d*2,10),new j({color:"#98a97c"}));return e.rotateX(-Math.PI/2),e},G=()=>{const e=new J,t=new K("#b9d5ff",.12),s=new Q("#b9d5ff",.3);return s.position.set(10,10,10),e.add(t),e.add(s),e},Y=()=>{const e=new $;return e.fog=new ee("#262837",1,30),e},B=e=>{const t=new te(45,e,1,1e3);return t.position.set(3,2,20),t.lookAt(0,0,0),t},Z=(e,t,s)=>{const n=new ne({canvas:e,antialias:!0});return n.setSize(t,s),n.setPixelRatio(window.devicePixelRatio),n},I=(e,t)=>{const s=new se(e,t);return s.enablePan=!1,s.minDistance=10,s.minPolarAngle=Math.PI/4,s.maxPolarAngle=Math.PI/2*.96,s};return oe(()=>{const e=P.value,t=R.value,s=t.clientWidth,n=t.clientHeight,i=Y(),l=B(s/n),u=Z(e,s,n),p=I(l,u.domElement),w=X();i.add(w);const m=L();i.add(m);const _=G();i.add(_);const f=()=>{let c=!1;const{position:o,customData:r}=m.geometry.attributes;for(let a=0,g=o.count;a<g;a++){const O=o.getX(a),k=o.getY(a),z=o.getZ(a),A=r.getX(a),S=r.getY(a),F=r.getZ(a),v=O+A,y=k+S,b=z+F;(v>d/4||v<-d/4)&&(c=!0,r.setX(a,-A)),(y>d/4||y<=1)&&(c=!0,r.setY(a,-S)),(b>d/4||b<=-d/4)&&(c=!0,r.setZ(a,-F)),o.setXYZ(a,v,y,b)}m.geometry.attributes.position.needsUpdate=!0,c&&(m.geometry.attributes.customData.needsUpdate=!0),p.update(),u.render(i,l),M=window.requestAnimationFrame(f)};f(),re(()=>{u.dispose(),u.forceContextLoss(),i.traverse(c=>{if(c instanceof U){const{geometry:o,material:r}=c;o&&o.dispose();const a=Array.isArray(r)?r:[r];for(const g of a)g&&g.dispose()}}),window.cancelAnimationFrame(M)})}),(e,t)=>(ce(),ie("div",{ref_key:"containerElementRef",ref:R,class:"container"},[de("canvas",{ref_key:"canvasElementRef",ref:P},null,512)],512))}},ge=ae(le,[["__scopeId","data-v-7302cea1"]]);export{ge as default};
