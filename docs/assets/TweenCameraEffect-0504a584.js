import{g as C,O as M,ad as T,z as A,af as z,h as D,aa as O,M as V,q as W,u as F,ai as G,V as j}from"./three.module-b50c6fca.js";import{T as q,E as U,u as H}from"./tween.esm-4d835848.js";import{O as N}from"./OrbitControls-a97fbd6e.js";import{s as Q}from"./scene-329a337a.js";import{l as X,h as Y}from"./gmhuo-8b7c69f8.js";import{_ as J,r as k,o as K,a as Z,b as $,c as ee,d as x,p as te,e as ne}from"./index-965901d4.js";const oe=w=>(te("data-v-18d2b4bb"),w=w(),ne(),w),se=oe(()=>x("span",{class:"tip"},"点击页面中图片模型实现镜头运动",-1)),ae={__name:"TweenCameraEffect",setup(w){let b=null;const v=k(null),y=k(null),R=()=>new T,I=t=>{const e=new A(45,t,1,1e3);return e.position.set(0,0,60),e.lookAt(0,0,0),e},L=(t,e)=>new N(t,e),P=(t,e,o)=>{const n=new z({canvas:t,antialias:!0});return n.setSize(e,o),n.setPixelRatio(window.devicePixelRatio),n},h=t=>{const e=new D,o=new O(16,9),n=new V({map:e.load(t),side:W});return new F(o,n)},S=t=>{const{containerElement:e,objects:o,camera:n,callback:s}=t,a=e.getBoundingClientRect(),c=new G,i=new j,l=m=>{i.x=(m.clientX-a.left)/a.width*2-1,i.y=-((m.clientY-a.top)/a.height)*2+1,c.setFromCamera(i,n);const d=c.intersectObjects(o);d.length>0&&s&&s(d[0].object)};return e.addEventListener("click",l),()=>e.removeEventListener("click",l)};return K(()=>{const t=v.value,e=y.value,o=e.clientWidth,n=e.clientHeight,s=R(),a=I(o/n),c=P(t,o,n),i=L(a,c.domElement),l=[Q,X,Y],m=h(l[0]);m.position.set(-10,0,0),m.rotation.y=1,s.add(m);const d=h(l[1]);d.position.set(10,0,10),d.rotation.y=-1,s.add(d);const g=h(l[2]);g.position.set(0,0,-20),g.rotation.y=.5,s.add(g);const B=S({containerElement:e,camera:a,objects:s.children,callback:p=>{if(!p.isMesh)return;const f=20,r=p.position.clone(),u=p.getWorldDirection(new C),_=new C(r.x+f*u.x,r.y+f*u.y,r.z+f*u.z);new q(a.position).to(_,1e3).easing(U.Quadratic.InOut).onUpdate(()=>{i.target=r}).start()}}),E=()=>{H(),i.update(),c.render(s,a),b=window.requestAnimationFrame(E)};E(),Z(()=>{B(),c.dispose(),c.forceContextLoss(),s.traverse(p=>{if(p instanceof M){const{geometry:f,material:r}=p;f&&f.dispose();const u=Array.isArray(r)?r:[r];for(const _ of u)_&&_.dispose()}}),window.cancelAnimationFrame(b)})}),(t,e)=>($(),ee("div",{ref_key:"containerElementRef",ref:y,class:"container"},[se,x("canvas",{ref_key:"canvasElementRef",ref:v},null,512)],512))}},pe=J(ae,[["__scopeId","data-v-18d2b4bb"]]);export{pe as default};
