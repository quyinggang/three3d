import{ao as W,g as k,O as j,G as q,ah as H,M,u as R,ap as I,x as T,s as D,o as N,aq as U,ad as X,z as J,af as K}from"./three.module-8f39f104.js";import{_ as Q,r as y,o as Y,a as Z,b as $,c as ee,d as b}from"./index-7c705545.js";const te={__name:"CameraView",setup(ne){const _=y(null),x=y(null),f=y(0);let g=null;const B=()=>{const e=new q,t=[{x:1,y:1,z:-1},{x:1,y:0,z:1},{x:-1,y:0,z:1},{x:-1,y:0,z:-1}],a=new H(.1,.1,.1),o=new M;for(const l of t){const m=new R(a,o);m.position.copy(l),e.add(m)}const n=new I(e.children.map(l=>l.position),!0);n.curveType="centripetal";const s=n.getPoints(50),i=new T(new D().setFromPoints(s),new N({color:65280}));return[e,i,n]},G=()=>{const e=new U(.04,.3,32);e.rotateX(Math.PI/2);const t=new M({color:16776960});return new R(e,t)},L=()=>new X,E=e=>new J(45,e,.1,1e3),V=(e,t,a)=>{const o=new K({canvas:e,antialias:!0});return o.setSize(t,a),o.setPixelRatio(window.devicePixelRatio),o},z=()=>{f.value=1-f.value};return Y(()=>{const e=_.value,t=x.value,a=t.clientWidth,o=t.clientHeight,n=L(),s=E(a/o),i=V(e,a,o),l=new W(s);n.add(l);const[m,O,h]=B();n.add(m),n.add(O);const p=G();n.add(p);let d=0;const C=.0015,u=new k,w=new k,S=()=>{if(d<=1-C){const c=h.getPointAt(d),r=h.getTangentAt(d).add(c);f.value===0?(u.set(3,3,3),w.set(0,0,0)):(u.copy(c),w.copy(r)),p.position.copy(c),p.lookAt(r),s.position.copy(u),s.lookAt(w),d+=C}else d=0},A=()=>{S(),i.render(n,s),g=window.requestAnimationFrame(A)};A(),Z(()=>{i.dispose(),i.forceContextLoss(),n.traverse(c=>{if(c instanceof j){const{geometry:v,material:r}=c;v&&v.dispose();const F=Array.isArray(r)?r:[r];for(const P of F)P&&P.dispose()}}),window.cancelAnimationFrame(g)})}),(e,t)=>($(),ee("div",{ref_key:"containerElementRef",ref:x,class:"container"},[b("span",{class:"button",onClick:z},"切换视角"),b("canvas",{ref_key:"canvasElementRef",ref:_},null,512)],512))}},se=Q(te,[["__scopeId","data-v-4a8f5ffd"]]);export{se as default};
